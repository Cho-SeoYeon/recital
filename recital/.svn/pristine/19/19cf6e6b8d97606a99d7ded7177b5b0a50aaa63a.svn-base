<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %>
<!DOCTYPE html>
<meta id="_csrf" name="_csrf" content="${_csrf.token}">
<meta id="_csrf_header" name="_csrf_header" content="${_csrf.headerName}">

<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="py-3 mb-4" style="font-weight:bold; padding-left:20px;">증명서 관리</h4>
    <div class="row">
        <div class="col-xl-12">
            <div class="col-sm-2">
                <form id="searchForm" method="get" action="/admin/certificationList">
                    <input type="hidden" name="page" id="page">
                    <input type="text" class="form-control" id="searchType" name="searchType" placeholder="검색어 입력" value="${param.searchType}">
                    <button type="submit" class="btn btn-primary mt-2">검색</button>
                    <sec:csrfInput/>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-xl-12">
        <div class="card mb-4 bg-white">
            <h5 class="card-header">증명서 목록</h5>
            <hr class="my-0">
            <div class="table-responsive text-nowrap">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>증명서명</th>
                            <th>요금</th>
                            <th>상세보기</th>
                            <th>활성화/비활성화여부</th>
                        </tr>
                    </thead>
                    <tbody class="table-border-bottom-0" id="tbody">
                        <c:set value="${pagingVO.dataList }" var="certificationList"/>
                        <c:forEach var="certification" items="${certificationList}" varStatus="status">
                            <tr>
                                <td>${certification.rnum}</td>
                                <td>${certification.cerName}</td>
                                <td>${certification.cerCharge}원</td>
                                <td><a class='btn btn-outline-primary detailBtn' href='/admin/certificationDetail?cerNo=${certification.cerNo}'>상세보기</a></td>
                                <td>
                        		<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" />
                        		<label class="form-check-label" for="flexSwitchCheckDefault">활성화/비활성화</label>
                                </td>
                            </tr>
                        </c:forEach>
                    </tbody>
                </table>
            </div>
            <div class="card-footer" align="right">
                <div class="card-footer clearfix" id="pagingArea">
                    ${pagingVO.pagingHTML }
                </div>
                <div class="card-footer">
                    <!-- 등록 버튼 -->
                    <button type="button" class="btn btn-primary" id="insertBtn">등록</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
$(function(){
    var token = $("meta[name='_csrf']").attr("content");
    var header = $("meta[name='_csrf_header']").attr("content");

    var pagingArea = $("#pagingArea");
    var searchForm = $("#searchForm");

    pagingArea.on("click", "a", function(event){
        event.preventDefault(); // a태그의 href속성 이벤트를 꺼준다.
        var pageNo = $(this).data("page"); // pageNo 전달
        searchForm.find("#page").val(pageNo);
        searchForm.submit();
    });

    // 등록 버튼 이벤트
    $("#insertBtn").click(function(){
        location.href="/admin/certificationInsertForm";    	
    });
});
</script>
